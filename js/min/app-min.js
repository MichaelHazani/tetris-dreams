"use strict";$(function(){Physijs.scripts.worker="./js/physijs_worker.js",Physijs.scripts.ammo="./ammo.js";var e,n,t,o,r,s,i,c,a,d,l,u,m,E,w,h,k,p,L,b,y=!1,P=!1,v=!1,f=!1,R=!1,j=!1,g=performance.now(),M=new THREE.Vector3,H="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document;if(H){var z=document.body,T=function(e){document.pointerLockElement===z||document.mozPointerLockElement===z||document.webkitPointerLockElement===z?(y=!0,b.enabled=!0):b.enabled=!1},x=function(e){};document.addEventListener("pointerlockchange",T,!1),document.addEventListener("mozpointerlockchange",T,!1),document.addEventListener("webkitpointerlockchange",T,!1),document.addEventListener("pointerlockerror",x,!1),document.addEventListener("mozpointerlockerror",x,!1),document.addEventListener("webkitpointerlockerror",x,!1),document.body.addEventListener("click",function(e){if(z.requestPointerLock=z.requestPointerLock||z.mozRequestPointerLock||z.webkitRequestPointerLock,/Firefox/i.test(navigator.userAgent)){var n=function(e){(document.fullscreenElement===z||document.mozFullscreenElement===z||document.mozFullScreenElement===z)&&(document.removeEventListener("fullscreenchange",n),document.removeEventListener("mozfullscreenchange",n),z.requestPointerLock())};document.addEventListener("fullscreenchange",n,!1),document.addEventListener("mozfullscreenchange",n,!1),z.requestFullscreen=z.requestFullscreen||z.mozRequestFullscreen||z.mozRequestFullScreen||z.webkitRequestFullscreen,z.requestFullscreen()}else z.requestPointerLock()},!1)}else document.body.innerHTML="Your browser doesn't seem to support Pointer Lock API";e=function(){p=new THREE.Clock,t=new THREE.WebGLRenderer({antialias:!0}),t.setSize(window.innerWidth,window.innerHeight),t.setClearColor(16777215),document.body.appendChild(t.domElement),o=new Physijs.Scene,r=new THREE.PerspectiveCamera(35,window.innerWidth/window.innerHeight,1,1e3),r.position.set(10,0,1),r.lookAt(o.position),o.add(r),b=new THREE.PointerLockControls(r),o.add(b.getObject());var e=function(e){switch(e.keyCode){case 38:case 87:P=!0;break;case 37:case 65:f=!0;break;case 40:case 83:v=!0;break;case 39:case 68:R=!0;break;case 32:j===!0&&(M.y+=350),j=!1}},c=function(e){switch(e.keyCode){case 38:case 87:P=!1;break;case 37:case 65:f=!1;break;case 40:case 83:v=!1;break;case 39:case 68:R=!1}};document.addEventListener("keydown",e,!1),document.addEventListener("keyup",c,!1),s=new Physijs.BoxMesh(new THREE.CubeGeometry(5,5,5),new THREE.MeshPhongMaterial({color:8947848})),o.add(s),h=new Physijs.SphereMesh(new THREE.SphereGeometry(3,15,15),new THREE.MeshPhongMaterial({color:5583430})),h.position.set(3,13,0),o.add(h),a=l=m=w=new THREE.JSONLoader,a.load("./JSON/R-shape.json",function(e){var n=new Physijs.BoxMesh(e,new THREE.MeshNormalMaterial);n.position.y=20,o.add(n)}),l.load("./JSON/cube.json",function(e){var n=new Physijs.BoxMesh(e,new THREE.MeshNormalMaterial);n.position.y=20,n.position.x=30,o.add(n)}),l.load("./JSON/cube.json",function(e){var n=new Physijs.BoxMesh(e,new THREE.MeshNormalMaterial);n.position.y=20,n.position.x=-20,o.add(n)}),k=new Physijs.BoxMesh(new THREE.BoxGeometry(700,1,700),new THREE.MeshBasicMaterial({color:8930354}),0),k.rotation.x=Math.PI,k.position.set(0,-2,0),o.add(k),i=new THREE.PointLight(16777215,1),i.position.set(0,17,0),o.add(i),requestAnimationFrame(n)},n=function(){if(y){var e=performance.now(),s=(e-g)/1e3;M.x-=10*M.x*s,M.z-=10*M.z*s,M.y-=9.8*100*s,P&&(M.z-=400*s),v&&(M.z+=400*s),f&&(M.x-=400*s),R&&(M.x+=400*s),b.getObject().translateX(M.x*s),b.getObject().translateY(M.y*s),b.getObject().translateZ(M.z*s),b.getObject().position.y<10&&(M.y=0,b.getObject().position.y=10,j=!0),g=e}o.simulate(),t.render(o,r),requestAnimationFrame(n)},e()});