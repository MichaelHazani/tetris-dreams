"use strict";$(function(){Physijs.scripts.worker="./js/physijs_worker.js",Physijs.scripts.ammo="./ammo.js";var e,t,n,o,a,i,r,s,c,d,l,m,u,E,h,p,w,M,k,T,f,R,g=!1,H=!1,v=!1,L=!1,b=!1,y=!1,x=performance.now(),j=new THREE.Vector3,z=200,P=0,B=20,S=5e3,q="pointerLockElement"in document||"mozPointerLockElement"in document||"webkitPointerLockElement"in document;if(q){var F=document.body,I=function(e){document.pointerLockElement===F||document.mozPointerLockElement===F||document.webkitPointerLockElement===F?(g=!0,R.enabled=!0):R.enabled=!1},O=function(e){};document.addEventListener("pointerlockchange",I,!1),document.addEventListener("mozpointerlockchange",I,!1),document.addEventListener("webkitpointerlockchange",I,!1),document.addEventListener("pointerlockerror",O,!1),document.addEventListener("mozpointerlockerror",O,!1),document.addEventListener("webkitpointerlockerror",O,!1),document.body.addEventListener("click",function(e){if(F.requestPointerLock=F.requestPointerLock||F.mozRequestPointerLock||F.webkitRequestPointerLock,/Firefox/i.test(navigator.userAgent)){var t=function(e){(document.fullscreenElement===F||document.mozFullscreenElement===F||document.mozFullScreenElement===F)&&(document.removeEventListener("fullscreenchange",t),document.removeEventListener("mozfullscreenchange",t),F.requestPointerLock())};document.addEventListener("fullscreenchange",t,!1),document.addEventListener("mozfullscreenchange",t,!1),F.requestFullscreen=F.requestFullscreen||F.mozRequestFullscreen||F.mozRequestFullScreen||F.webkitRequestFullscreen,F.requestFullscreen()}else F.requestPointerLock()},!1)}else document.body.innerHTML="Your browser doesn't seem to support Pointer Lock API";e=function(){function e(){a.aspect=window.innerWidth/window.innerHeight,a.updateProjectionMatrix(),n.setSize(window.innerWidth,window.innerHeight)}function i(){setTimeout(function(){var e=Math.floor(Math.random()*z+1),t=Math.floor(Math.random()*z+1);w.load("./JSON/R-shape.json",function(n){var a=new Physijs.BoxMesh(n,new THREE.MeshLambertMaterial({color:13882323}));a.scale.set(2,2,2),a.position.y=100,a.position.x=e,a.position.z=t,a.rotation.x=e,a.rotation.y=t,a.rotation.z=e,o.add(a)})},2e3)}function s(){setTimeout(function(){var e=Math.floor(Math.random()*z+1),t=Math.floor(Math.random()*z+1);w.load("./JSON/cube.json",function(n){var a=new Physijs.BoxMesh(n,new THREE.MeshLambertMaterial({color:128}));a.scale.set(2,2,2),a.position.y=100,a.position.x=e,a.position.z=t,a.rotation.x=e,a.rotation.y=t,a.rotation.z=e,o.add(a)})},2e3)}function d(){setTimeout(function(){var e=Math.floor(Math.random()*z+1),t=Math.floor(Math.random()*z+1);w.load("./JSON/squiggly.json",function(n){var a=new Physijs.BoxMesh(n,new THREE.MeshLambertMaterial({color:32896}));a.scale.set(2,2,2),a.position.y=100,a.position.x=e,a.position.z=t,a.rotation.x=e,a.rotation.y=t,a.rotation.z=e,o.add(a)})},2e3)}function m(){setTimeout(function(){var e=Math.floor(Math.random()*z+1),t=Math.floor(Math.random()*z+1);w.load("./JSON/pedestal.json",function(n){var a=new Physijs.BoxMesh(n,new THREE.MeshLambertMaterial({color:13789470}));a.scale.set(2,2,2),a.position.y=100,a.position.x=e,a.position.z=t,a.rotation.x=e,a.rotation.y=t,a.rotation.z=e,o.add(a)})},2e3)}function E(){setTimeout(function(){var e=Math.floor(Math.random()*z+1),t=Math.floor(Math.random()*z+1);w.load("./JSON/longline.json",function(n){var a=new Physijs.BoxMesh(n,new THREE.MeshLambertMaterial({color:8388608}));a.scale.set(2,2,2),a.position.y=100,a.position.x=e,a.position.z=t,a.rotation.x=e,a.rotation.y=t,a.rotation.z=e,o.add(a)})},2e3)}T=new THREE.Clock,n=new THREE.WebGLRenderer({antialias:!0}),n.setSize(window.innerWidth,window.innerHeight),n.setClearColor(16777215),document.body.appendChild(n.domElement),o=new Physijs.Scene,a=new THREE.PerspectiveCamera(35,window.innerWidth/window.innerHeight,1,1e3),a.position.set(10,0,1),a.lookAt(o.position),o.add(a),R=new THREE.PointerLockControls(a),o.add(R.getObject());var p=function(e){switch(e.keyCode){case 38:case 87:H=!0;break;case 37:case 65:L=!0;break;case 40:case 83:v=!0;break;case 39:case 68:b=!0;break;case 32:y===!0&&(j.y+=200),y=!1}},M=function(e){switch(e.keyCode){case 38:case 87:H=!1;break;case 37:case 65:L=!1;break;case 40:case 83:v=!1;break;case 39:case 68:b=!1}};document.addEventListener("keydown",p,!1),document.addEventListener("keyup",M,!1),window.addEventListener("resize",e,!1),c=l=u=h=w=new THREE.JSONLoader;var f=setInterval(function(){function e(e){switch(e){case 1:i();break;case 2:s();break;case 3:d();break;case 4:m();break;case 5:E()}}var t=Math.round(5*Math.random())+1;e(t%3==0?1:t%4==0?2:t%5==0?3:t%2==0?4:5),P++,P>=B&&clearInterval(f)},S),g=new THREE.ImageUtils.loadTexture("../images/checkers.gif");g.wrapS=THREE.RepeatWrapping,g.wrapt=THREE.RepeatWrapping,g.repeat.set(3,3),k=new Physijs.BoxMesh(new THREE.BoxGeometry(1e3,1,1e3),new THREE.MeshLambertMaterial({map:g}),0),k.rotation.x=Math.PI,k.position.set(0,-2,0),o.add(k),r=new THREE.PointLight(16777215,1),r.position.set(0,17,0),o.add(r);var x=new THREE.AmbientLight(16777215,.5);o.add(x),requestAnimationFrame(t);var q=new THREE.BoxGeometry(700,700,700),F=[];F.push(new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture("../images/sides.jpg"),side:THREE.BackSide})),F.push(new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture("../images/sides.jpg"),side:THREE.BackSide})),F.push(new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture("../images/top.jpg"),side:THREE.BackSide})),F.push(new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture("../images/bottom.jpg"),side:THREE.BackSide})),F.push(new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture("../images/sides.jpg"),side:THREE.BackSide})),F.push(new THREE.MeshBasicMaterial({map:THREE.ImageUtils.loadTexture("../images/sides.jpg"),side:THREE.BackSide}));var I=new THREE.MeshFaceMaterial(F),O=new THREE.Mesh(q,I);O.position.y=340,o.add(O)},t=function(){if(g){var e=performance.now(),i=(e-x)/1e3;j.x-=10*j.x*i,j.z-=10*j.z*i,j.y-=9.8*100*i,H&&(j.z-=400*i),v&&(j.z+=400*i),L&&(j.x-=400*i),b&&(j.x+=400*i),R.getObject().translateX(j.x*i),R.getObject().translateY(j.y*i),R.getObject().translateZ(j.z*i),x=e}o.simulate(),n.render(o,a),requestAnimationFrame(t)},e()});